import{a as l}from"./chunk-3QDBQQU5.js";import{h as W,i as X,j as Z,k as tt,l as et,n as nt,o as A,p as E,q as it,r as ot}from"./chunk-VB3MO2AL.js";import{$ as z,$a as v,Ea as f,Fa as q,Ha as Y,Ja as J,Ka as K,La as T,Ma as S,N as k,Na as C,Oa as u,Pa as c,Qa as d,Ra as Q,T as s,V as h,Va as I,Wa as D,_ as V,_a as p,fb as m,gb as M,i as N,k as $,n as y,ra as F,sa as G,w as B,wa as a}from"./chunk-O2WMGYX5.js";import{d as U}from"./chunk-JMZ7DUBM.js";var w=()=>()=>{let e=s(l),t=s(A);return e.isLoggedIn()?!0:t.parseUrl("auth/login")},rt=()=>()=>{let e=s(l),t=s(A);return e.isLoggedIn()?t.parseUrl("home"):!0};var st=[{path:"auth",canActivate:[rt()],loadChildren:()=>import("./chunk-UVRFJC4L.js").then(e=>e.AUTH_ROUTES)},{path:"client",canActivate:[w()],loadChildren:()=>import("./chunk-QNW2ZR76.js").then(e=>e.CLIENT_ROUTES)},{path:"provider",canActivate:[w()],loadChildren:()=>import("./chunk-4D6JQBQS.js").then(e=>e.PROVIDER_ROUTES)},{path:"search",loadChildren:()=>import("./chunk-RBC2XAQW.js").then(e=>e.SEARCH_ROUTES)},{path:"home",loadComponent:()=>import("./chunk-GOECHUA2.js").then(e=>e.HomeComponent)},{path:"",redirectTo:"home",pathMatch:"full"}];var _=(()=>{let t=class t{constructor(){this.toasts=G([])}show(i,n,r,g){let _t=[{type:i,title:n,body:r,delay:g},...this.toasts()];this.toasts.set(_t)}removeToast(i){this.toasts().splice(i,1)}removeLastToast(){this.toasts().pop()}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var at=(e,t)=>{let o=s(_),i=s(l);return t(e).pipe(B(n=>{if([401,403].includes(n.status))o.show("error","Sorry!","Unathorized. Please login again."),i.refreshToken();else if(n.status==400){let r="";n.error.message?n.error.message.forEach(g=>{r=r+g+`. 
`}):r="Something went wrong. Please try later.",o.show("error","Sorry!",r)}else n.status==500?o.show("error","Sorry!",n.error.message):o.show("error","Sorry!","Something went wrong. Please try later. ");return $(()=>n)}))};var ct=(()=>{let t=class t{constructor(){this.auth=s(l),this.toaster=s(_),this.count=0}intercept(i,n){return N(this.handle(i,n))}handle(i,n){return U(this,null,function*(){if(!this.auth?.user()?.accessToken)return yield y(n.handle(i));if(!this.auth.isTokenExpired()){this.count=0;let r=L(i,this.auth.user()?.accessToken);return yield y(n.handle(r))}if(this.auth.isTokenExpired()&&this.count==1){let r=L(i,this.auth.user()?.accessToken);return yield y(n.handle(r))}if(this.auth.isTokenExpired()&&this.count==2&&(this.count=0,this.auth.logout("login")),this.auth.isTokenExpired()&&this.count==0){this.count++;let r=this.auth.refreshToken(),g=yield y(r);this.auth.setUser(g),this.toaster.show("success","Attn","Token refreshed.");let H=L(i,this.auth.user()?.accessToken);return yield y(n.handle(H))}else return yield y(n.handle(i))})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),L=(e,t)=>e.clone({setHeaders:{Authorization:`Bearer ${t}`}});var lt={providers:[{provide:W,useClass:ct,multi:!0},ot(st),X(tt(),Z([at]))]};var b=()=>({exact:!0});function yt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,b)),a(1),v(o.name)}}function vt(e,t){if(e&1){let o=Q();S(0,yt,3,4,"li",null,T),d(2,"span",1),u(3,"li")(4,"a",2),I("click",function(){V(o);let n=D();return z(n.logout())}),p(5,"Logout"),c()()}if(e&2){let o=D();C(o.loggedInMenuItems)}}function gt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,b)),a(1),v(o.name)}}function Tt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,b)),a(1),v(o.name)}}function St(e,t){if(e&1&&(S(0,gt,3,4,"li",null,T),d(2,"span",1),S(3,Tt,3,4,"li",null,T)),e&2){let o=D();C(o.menuItems),a(3),C(o.authMenuItems)}}var ut=(()=>{let t=class t{constructor(){this.auth=s(l),this.userRoute="client",this.loggedIn=F(()=>this.auth.isLoggedIn()),this.logout=()=>{this.auth.logout("home")},this.menuItems=[{name:"Find Provider",url:"/search/providers"}],this.loggedInMenuItems=[],this.clientMenuItems=[{name:"Dashboard",url:"client/dashboard"},{name:"Account",url:"client/account"},{name:"Find Provider",url:"/search/providers"}],this.providerMenuItems=[{name:"Dashboard",url:"provider/dashboard"},{name:"Account",url:"provider/account"}],this.authMenuItems=[{name:"Login",url:"auth/login"},{name:"Sign up",url:"auth/registration"}]}ngOnInit(){this.auth.user().user?.isProvider?this.loggedInMenuItems=this.providerMenuItems:this.loggedInMenuItems=this.clientMenuItems}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=h({type:t,selectors:[["app-header-nav-menu"]],standalone:!0,features:[m],decls:3,vars:1,consts:[[1,"nav-links"],[1,"pa-md"],[1,"nav-link",3,"click"],["routerLinkActive","active-link",3,"routerLink","routerLinkActiveOptions"]],template:function(n,r){n&1&&(u(0,"ul",0),J(1,vt,6,0)(2,St,5,0),c()),n&2&&(a(1),K(1,r.loggedIn()?1:2))},dependencies:[E,it],styles:["[_nghost-%COMP%]{margin-left:auto}"]});let e=t;return e})();var pt=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=h({type:t,selectors:[["app-header"]],standalone:!0,features:[m],decls:6,vars:1,consts:[[1,"header"],[1,"container","container-md","items-center","flex"],[1,""],["routerLinkActive","active-link",3,"routerLink"]],template:function(n,r){n&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),p(4,"Brand"),c()(),d(5,"app-header-nav-menu"),c()()),n&2&&(a(3),f("routerLink","home"))},dependencies:[ut,E]});let e=t;return e})();function ht(e,t){return{type:7,name:e,definitions:t,options:{}}}function P(e,t=null){return{type:4,styles:t,timings:e}}function O(e){return{type:6,styles:e,offset:null}}function R(e,t,o){return{type:0,name:e,styles:t,options:o}}function j(e,t,o=null){return{type:1,expr:e,animation:t,options:o}}var mt=(()=>{let t=class t{constructor(){this.toaster=s(_)}ngOnInit(){setTimeout(()=>this.toaster.removeLastToast(),this.toast.delay||6e3)}removeToast(){this.toaster.removeToast(this.i)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=h({type:t,selectors:[["app-toaster-details"]],inputs:{toast:"toast",i:"i"},standalone:!0,features:[m],decls:7,vars:7,consts:[[1,"toast-heading"],[1,"close",3,"click"]],template:function(n,r){n&1&&(u(0,"div")(1,"h4",0),p(2),c(),u(3,"p"),p(4),c(),u(5,"a",1),I("click",function(){return r.removeToast()}),p(6,"\xD7"),c()()),n&2&&(Y("toast toast-",r.toast.type,""),q("bottom",r.i*100,"px"),a(2),v(r.toast.title),a(2),v(r.toast.body))},data:{animation:[ht("toasterState",[R("inactive",O({opacity:0})),R("active",O({opacity:1})),j("inactive => active",P("500ms ease-in")),j("active => inactive",P("500ms ease-out"))])]}});let e=t;return e})();function Ct(e,t){if(e&1&&d(0,"app-toaster-details",0),e&2){let o=t.$implicit,i=t.$index;f("toast",o)("i",i)}}var dt=(()=>{let t=class t{constructor(){this.toaster=s(_),this.toasts=F(()=>this.toaster.toasts())}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=h({type:t,selectors:[["app-toaster"]],standalone:!0,features:[m],decls:2,vars:0,consts:[[3,"toast","i"]],template:function(n,r){n&1&&S(0,Ct,1,2,"app-toaster-details",0,T),n&2&&C(r.toasts())},dependencies:[mt]});let e=t;return e})();var ft=(()=>{let t=class t{constructor(){this.title="socket-io",this.authService=s(l)}ngOnInit(){console.log("app component initialized",this.authService.user()?.accessToken)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=h({type:t,selectors:[["app-root"]],standalone:!0,features:[m],decls:3,vars:0,template:function(n,r){n&1&&d(0,"app-header")(1,"router-outlet")(2,"app-toaster")},dependencies:[nt,pt,dt]});let e=t;return e})();et(ft,lt).catch(e=>console.error(e));
