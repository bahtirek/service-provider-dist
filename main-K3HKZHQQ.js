import{a as l}from"./chunk-O6KTZ5NC.js";import{i as W,j as X,k as Z,l as tt,m as et,o as it,p as A,q as E,r as nt,s as ot}from"./chunk-YKD7L7GY.js";import{$ as z,$a as p,Fa as f,Ga as q,Ia as Y,Ka as J,La as K,Ma as T,N as x,Na as S,Oa as C,Pa as u,Qa as c,Ra as m,Sa as Q,T as s,V as h,Wa as I,Xa as D,_ as V,ab as v,gb as d,hb as M,i as N,k as $,n as y,sa as F,ta as G,w as B,xa as a}from"./chunk-BWQSIJDM.js";import{d as U}from"./chunk-JMZ7DUBM.js";var w=()=>()=>{let e=s(l),t=s(A);return e.isLoggedIn()?!0:t.parseUrl("auth/login")},rt=()=>()=>{let e=s(l),t=s(A);return e.isLoggedIn()?t.parseUrl("home"):!0};var st=[{path:"auth",canActivate:[rt()],loadChildren:()=>import("./chunk-TFKHWFBV.js").then(e=>e.AUTH_ROUTES)},{path:"client",canActivate:[w()],loadChildren:()=>import("./chunk-O7H3QICD.js").then(e=>e.CLIENT_ROUTES)},{path:"provider",canActivate:[w()],loadChildren:()=>import("./chunk-I3T7UATL.js").then(e=>e.PROVIDER_ROUTES)},{path:"search",loadChildren:()=>import("./chunk-G3SC2WOY.js").then(e=>e.SEARCH_ROUTES)},{path:"home",loadComponent:()=>import("./chunk-RVVJ7H4S.js").then(e=>e.HomeComponent)},{path:"",redirectTo:"home",pathMatch:"full"}];var _=(()=>{let t=class t{constructor(){this.toasts=G([])}show(n,i,r,g){let _t=[{type:n,title:i,body:r,delay:g},...this.toasts()];this.toasts.set(_t)}removeToast(n){this.toasts().splice(n,1)}removeLastToast(){this.toasts().pop()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var at=(e,t)=>{let o=s(_),n=s(l);return t(e).pipe(B(i=>{if([401,403].includes(i.status))o.show("error","Sorry!","Unathorized. Please login again."),n.refreshToken();else if(i.status==400){let r="";i.error.message?i.error.message.forEach(g=>{r=r+g+`. 
`}):r="Something went wrong. Please try later.",o.show("error","Sorry!",r)}else i.status==500?o.show("error","Sorry!",i.error.message):o.show("error","Sorry!","Something went wrong. Please try later. ");return $(()=>i)}))};var ct=(()=>{let t=class t{constructor(){this.auth=s(l),this.toaster=s(_),this.count=0}intercept(n,i){return N(this.handle(n,i))}handle(n,i){return U(this,null,function*(){if(!this.auth?.user()?.accessToken)return yield y(i.handle(n));if(!this.auth.isTokenExpired()){this.count=0;let r=L(n,this.auth.user()?.accessToken);return yield y(i.handle(r))}if(this.auth.isTokenExpired()&&this.count==1){let r=L(n,this.auth.user()?.accessToken);return yield y(i.handle(r))}if(this.auth.isTokenExpired()&&this.count==2&&(this.count=0,this.auth.logout("login")),this.auth.isTokenExpired()&&this.count==0){this.count++;let r=this.auth.refreshToken(),g=yield y(r);this.auth.setUser(g),this.toaster.show("success","Attn","Token refreshed.");let H=L(n,this.auth.user()?.accessToken);return yield y(i.handle(H))}else return yield y(i.handle(n))})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),L=(e,t)=>e.clone({setHeaders:{Authorization:`Bearer ${t}`}});var lt={providers:[{provide:W,useClass:ct,multi:!0},ot(st),X(tt(),Z([at]))]};var P=()=>({exact:!0});function yt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,P)),a(1),v(o.name)}}function vt(e,t){if(e&1){let o=Q();S(0,yt,3,4,"li",null,T),m(2,"span",1),u(3,"li")(4,"a",2),I("click",function(){V(o);let i=D();return z(i.logout())}),p(5,"Logout"),c()()}if(e&2){let o=D();C(o.loggedInMenuItems)}}function gt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,P)),a(1),v(o.name)}}function Tt(e,t){if(e&1&&(u(0,"li")(1,"a",3),p(2),c()()),e&2){let o=t.$implicit;a(1),f("routerLink",o.url)("routerLinkActiveOptions",M(3,P)),a(1),v(o.name)}}function St(e,t){if(e&1&&(S(0,gt,3,4,"li",null,T),m(2,"span",1),S(3,Tt,3,4,"li",null,T)),e&2){let o=D();C(o.menuItems),a(3),C(o.authMenuItems)}}var ut=(()=>{let t=class t{constructor(){this.auth=s(l),this.userRoute="client",this.loggedIn=F(()=>this.auth.isLoggedIn()),this.logout=()=>{this.auth.logout("home")},this.menuItems=[{name:"Find Provider",url:"/search/providers",icon:"search"}],this.loggedInMenuItems=[],this.clientMenuItems=[{name:"Dashboard",url:"client/dashboard",icon:"dashboard"},{name:"Find Provider",url:"/search/providers",icon:"search"},{name:"My Profile",url:"client/profile",icon:"manage_accounts"}],this.providerMenuItems=[{name:"Dashboard",url:"provider/dashboard",icon:"dashboard"},{name:"My Profile",url:"provider/profile",icon:"manage_account"},{name:"Find Provider",url:"/search/providers",icon:"search"}],this.authMenuItems=[{name:"Login",url:"auth/login",icon:"login"},{name:"Sign up",url:"auth/registration",icon:"person_add"}]}ngOnInit(){this.auth.user().user?.isProvider?this.loggedInMenuItems=this.providerMenuItems:this.loggedInMenuItems=this.clientMenuItems}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-header-nav-menu"]],standalone:!0,features:[d],decls:3,vars:1,consts:[[1,"nav-links"],[1,"pa-md"],[1,"nav-link",3,"click"],["routerLinkActive","active-link",3,"routerLink","routerLinkActiveOptions"]],template:function(i,r){i&1&&(u(0,"ul",0),J(1,vt,6,0)(2,St,5,0),c()),i&2&&(a(1),K(1,r.loggedIn()?1:2))},dependencies:[E,nt],styles:["[_nghost-%COMP%]{margin-left:auto}"]});let e=t;return e})();var pt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-header"]],standalone:!0,features:[d],decls:6,vars:1,consts:[[1,"header"],[1,"container","container-md","items-center","flex"],[1,""],["routerLinkActive","active-link",3,"routerLink"]],template:function(i,r){i&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),p(4,"Brand"),c()(),m(5,"app-header-nav-menu"),c()()),i&2&&(a(3),f("routerLink","home"))},dependencies:[ut,E]});let e=t;return e})();function ht(e,t){return{type:7,name:e,definitions:t,options:{}}}function b(e,t=null){return{type:4,styles:t,timings:e}}function O(e){return{type:6,styles:e,offset:null}}function R(e,t,o){return{type:0,name:e,styles:t,options:o}}function j(e,t,o=null){return{type:1,expr:e,animation:t,options:o}}var dt=(()=>{let t=class t{constructor(){this.toaster=s(_)}ngOnInit(){setTimeout(()=>this.toaster.removeLastToast(),this.toast.delay||6e3)}removeToast(){this.toaster.removeToast(this.i)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-toaster-details"]],inputs:{toast:"toast",i:"i"},standalone:!0,features:[d],decls:7,vars:7,consts:[[1,"toast-heading"],[1,"close",3,"click"]],template:function(i,r){i&1&&(u(0,"div")(1,"h4",0),p(2),c(),u(3,"p"),p(4),c(),u(5,"a",1),I("click",function(){return r.removeToast()}),p(6,"\xD7"),c()()),i&2&&(Y("toast toast-",r.toast.type,""),q("bottom",r.i*100,"px"),a(2),v(r.toast.title),a(2),v(r.toast.body))},data:{animation:[ht("toasterState",[R("inactive",O({opacity:0})),R("active",O({opacity:1})),j("inactive => active",b("500ms ease-in")),j("active => inactive",b("500ms ease-out"))])]}});let e=t;return e})();function Ct(e,t){if(e&1&&m(0,"app-toaster-details",0),e&2){let o=t.$implicit,n=t.$index;f("toast",o)("i",n)}}var mt=(()=>{let t=class t{constructor(){this.toaster=s(_),this.toasts=F(()=>this.toaster.toasts())}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-toaster"]],standalone:!0,features:[d],decls:2,vars:0,consts:[[3,"toast","i"]],template:function(i,r){i&1&&S(0,Ct,1,2,"app-toaster-details",0,T),i&2&&C(r.toasts())},dependencies:[dt]});let e=t;return e})();var ft=(()=>{let t=class t{constructor(){this.title="socket-io",this.authService=s(l)}ngOnInit(){console.log("app component initialized",this.authService.user()?.accessToken)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-root"]],standalone:!0,features:[d],decls:3,vars:0,template:function(i,r){i&1&&m(0,"app-header")(1,"router-outlet")(2,"app-toaster")},dependencies:[it,pt,mt]});let e=t;return e})();et(ft,lt).catch(e=>console.error(e));
